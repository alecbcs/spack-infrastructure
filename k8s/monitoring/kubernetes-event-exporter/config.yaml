apiVersion: v1
kind: ConfigMap
metadata:
  name: event-exporter-cfg
  namespace: monitoring
data:
  config.yaml: |
    logLevel: error
    logFormat: json
    route:
      # Main route
      routes:
        # This route allows dumping all events because it has no fields to match and no drop rules.
        - match:
            - receiver: "runner-events"
            - namespace: "gitlab"
          # drop:
          #   - type: "Normal"
    receivers:
      - name: "runner-events"
        opensearch:
          hosts:
            - http://localhost:9200
          index: kube-events
          # Ca be used optionally for time based indices, accepts Go time formatting directives
          indexFormat: "kube-events-{2006-01-02}"
          # If set to true, it allows updating the same document in ES (might be useful handling count)
          useEventID: true
          # Type should be only used for clusters Version 6 and lower.
          # type: kube-event
          # If set to true, all dots in labels and annotation keys are replaced by underscores. Defaults false
          deDot: false
          tls: # optional, advanced options for tls
            insecureSkipVerify: true|false # optional, if set to true, the tls cert won't be verified
            serverName: # optional, the domain, the certificate was issued for, in case it doesn't match the hostname used for the connection
            caFile: # optional, path to the CA file of the trusted authority the cert was signed with 
